#! /usr/bin/env perl
use strict;
use warnings;

my %grandfathered = (
    '0C2CD63DF7806FA399EDE809116B575BF87989F06518F9808C860503178BAF66' => 1,
    '2399561127A57125DE8CEFEA610DDF2FA078B5C8067F4E828290BFB860E84B3C' => 1,
    '349DFA4058C5E263123B398AE795573C4E1313C83FE68F93556CD5E8031B3C7D' => 1,
    '34D8A73EE208D9BCDB0D956520934B4E40E69482596E8B6F73C8426B010A6F48' => 1,
    '37D51006C512EAAB626421F1EC8C92013FC5F82AE98EE533EB4619B8DEB4D06C' => 1,
    '4B03F45807AD70F21BFC2CAE71C9FDE4604C064CF5FFB686BAE5DBAAD7FDD34C' => 1,
    '5EDB7AC43B82A06A8761E8D7BE4979EBF2611F7DD79BF91C1C6B566A219ED766' => 1,
    '69DDD7EA90BB57C93E135DC85EA6FCD5480B603239BDC454FC758B2A26CF7F79' => 1,
    '8D25CD97229DBF70356BDA4EB3CC734031E24CF00FAFCFD32DC76EB5841C7EA8' => 1,
    '8D722F81A9C113C0791DF136A2966DB26C950A971DB46B4199F4EA54B78BFB9F' => 1,
    '9ACFAB7E43C8D880D06B262A94DEEEE4B4659989C3D0CAF19BAF6405E41AB7DF' => 1,
    'A22DBA681E97376E2D397D728AAE3A9B6296B9FDBA60BC2E11F647F2C675FB37' => 1,
    'A4310D50AF18A6447190372A86AFAF8B951FFB431D837F1E5688B45971ED1557' => 1,
    'B478B812250DF878635C2AA7EC7D155EAA625EE82916E2CD294361886CD1FBD4' => 1,
    'BEC94911C2955676DB6C0A550986D76E3BA005667C442C9762B4FBB773DE228C' => 1,
    'D8E0FEBC1DB2E38D00940F37D27D41344D993E734B99D5656D9778D4D8143624' => 1,
    'D947432ABDE7B7FA90FC2E6B59101B1280E0E1C7E4E40FA3C6887FFF57A7F4CF' => 1,
    'DB3517D1F6732A2D5AB97C533EC70779EE3270A62FB4AC4238372460E6F01E88' => 1,
    'EB04CF5EB1F39AFA762F2BB120F296CBA520C1B97DB1589565B81CB9A17B7244' => 1,
);

my %certfiles;
foreach my $DIR ( 'certs.akamai' ) {
    chdir $DIR || die "Can't chdir $DIR, $!";
    foreach my $FILE ( <*> ) {
	$certfiles{$FILE} = 1 if not $grandfathered{$FILE};
    }
    chdir ".." || die "Can't chdir up from $DIR, $!";
}


my @deleted = grep {
    ! -f "certs.apple/$_"
    || ! -f "certs.google/$_"
    || ! -f "certs.microsoft/$_"
    || ! -f "certs.mozilla/$_" } sort keys %certfiles;

foreach my $FILE ( @deleted ) {
    print "$FILE\n";
}
